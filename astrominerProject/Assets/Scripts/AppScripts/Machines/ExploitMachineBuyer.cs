using System;
using SBaier.DI;

namespace SBaier.Astrominer
{
    public class ExploitMachineBuyer : Injectable
    {
        private Factory<ExploitMachine, ExploitMachineLevelSettings> _factory;

        public void Inject(Resolver resolver)
        {
            _factory = resolver.Resolve<Factory<ExploitMachine, ExploitMachineLevelSettings>>();
        }

        public ExploitMachine BuyMachine(Player player, ExploitMachineLevelSettings levelSettings)
        {
            float price = levelSettings.Price;
            if (!player.Credits.Has(price))
                throw new InvalidOperationException();
            player.Credits.Request(price);
            return _factory.Create(levelSettings);
        }
    }
}
